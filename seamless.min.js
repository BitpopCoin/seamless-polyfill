(function(win,doc){"use strict";var allowed_domains=["*"],allowed_domains_length=allowed_domains.length,target_origin="*",frames={},setOptions=function(options){options.allowed_domains&&(allowed_domains=options.allowed_domains,allowed_domains_length=allowed_domains.length),options.target_origin&&(target_origin=options.target_origin)},checkDomain=function(origin){var i;for(i=0;allowed_domains_length>i;i++)if(allowed_domains[i]===origin)return!0;return!1},sendHeight=function(){win.parent.postMessage(JSON.stringify({height:doc.body.scrollHeight,href:win.location.href}),target_origin)},heightListener=function(evt){if(checkDomain(e.origin)){var data=JSON.parse(evt.data);data.request&&"height"===data.request&&sendHeight()}},setFrameHeight=function(evt){if(checkDomain(evt.origin)){var frame,data=JSON.parse(evt.data);data.height&&data.href&&(frame=frames[data.href],frame&&(frame.style.height=parseInt(data.height,10)+"px"))}},frame=function(options){setOptions(options),win.onmessage=heightListener,win.onload=sendHeight},parent=function(options){setOptions(options);var i,elements=doc.querySelectorAll("iframe[seamless]"),len=elements.length;for(i=0;len>i;i++)frames[elements[i].src]=elements[i];window.addEventListener("message",setFrameHeight)},seamless={frame:frame,parent:parent};"function"==typeof define&&define.amd?define([],function(){return seamless}):"undefined"!=typeof module&&null!==module?module.exports=seamless:window.seamless=seamless})(window,document);